# ğŸ½ï¸ NutriFlow AI - æ™ºèƒ½è¥å…»åˆ†æç³»ç»Ÿ

<div align="center">

**åŸºäº AI çš„å…¨æ ˆè¥å…»è¿½è¸ªå¹³å°**

åŸºäº LangChain 1.0 + LangGraph | é˜¿é‡Œå·´å·´é€šä¹‰åƒé—®æ¨¡å‹ | React + TypeScript æ„å»º

[English](./README.md) | ç®€ä½“ä¸­æ–‡

[åŠŸèƒ½ç‰¹æ€§](#-åŠŸèƒ½ç‰¹æ€§) â€¢ [ç³»ç»Ÿæ¶æ„](#-ç³»ç»Ÿæ¶æ„) â€¢ [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹) â€¢ [æ–‡æ¡£](#-æ–‡æ¡£) â€¢ [API](#-api-æ–‡æ¡£)

</div>

---

## ğŸ“– é¡¹ç›®æ¦‚è¿°

NutriFlow AI æ˜¯ä¸€ä¸ªç»¼åˆæ€§çš„è¥å…»åˆ†æå¹³å°ï¼Œä½¿ç”¨å‰æ²¿çš„ AI æŠ€æœ¯å¸®åŠ©ç”¨æˆ·è¿½è¸ªé¥®é£Ÿæ‘„å…¥ã€åˆ†æè¥å…»å¹³è¡¡å¹¶æä¾›ä¸ªæ€§åŒ–çš„è†³é£Ÿå»ºè®®ã€‚

### ä¸ºä»€ä¹ˆé€‰æ‹© NutriFlowï¼Ÿ

- ğŸ¤– **AI é©±åŠ¨åˆ†æ**: åˆ©ç”¨é˜¿é‡Œå·´å·´é€šä¹‰åƒé—®å¤šæ¨¡æ€æ¨¡å‹è¿›è¡Œç²¾å‡†çš„èœå“è¯†åˆ«
- ğŸ” **è®¡ç®—æœºè§†è§‰**: è‡ªåŠ¨è¯†åˆ«å•å¼ ç…§ç‰‡ä¸­çš„å¤šä¸ªèœå“
- ğŸ“Š **å®æ—¶è¥å…»æ•°æ®**: è”ç½‘æŸ¥è¯¢æœ€æ–°çš„è¥å…»ä¿¡æ¯
- ğŸ¯ **ä¸ªæ€§åŒ–æ´å¯Ÿ**: AI é©±åŠ¨çš„å¥åº·è¯„åˆ†å’Œè†³é£Ÿæ¨è
- ğŸ“ˆ **è¶‹åŠ¿åˆ†æ**: 7 å¤©é¥®é£Ÿæ¨¡å¼è¿½è¸ªå’Œæ´å¯Ÿ
- ğŸŒ **å…¨æ ˆè§£å†³æ–¹æ¡ˆ**: ä» AI åç«¯åˆ° React å‰ç«¯çš„å®Œæ•´ç³»ç»Ÿ

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒèƒ½åŠ›

| åŠŸèƒ½ | æè¿° |
|------|------|
| ğŸ” **æ™ºèƒ½å›¾åƒè¯†åˆ«** | Qwen-VL-Plus é«˜ç²¾åº¦è¯†åˆ«ç›˜ä¸­æ‰€æœ‰èœå“ |
| âš–ï¸ **ä»½é‡ä¼°ç®—** | AI ä¼°ç®—ä»½é‡å¤§å°ï¼ˆå°/ä¸­/å¤§ï¼‰å¹¶éªŒè¯åˆç†æ€§ |
| ğŸŒ **åœ¨çº¿è¥å…»æŸ¥è¯¢** | å®æ—¶ç½‘ç»œæœç´¢è·å–æœ€æ–°è¥å…»æ•°æ® |
| ğŸ“Š **è¥å…»è®¡ç®—** | è®¡ç®— 5 å¤§å…³é”®è¥å…»ç´ ï¼šçƒ­é‡ã€è›‹ç™½è´¨ã€è„‚è‚ªã€ç¢³æ°´åŒ–åˆç‰©ã€é’  |
| ğŸ¯ **å¥åº·è¯„åˆ†** | åŸºäºè¥å…»å¹³è¡¡æä¾›è¯„åˆ†ï¼ˆ0-100ï¼‰|
| ğŸ“ˆ **é¥®é£Ÿè¶‹åŠ¿** | åˆ†ææœ€è¿‘ 7 å¤©çš„é¥®é£Ÿæ¨¡å¼ |
| ğŸ• **ç”¨é¤ç±»å‹æ¨æ–­** | ä»æ—¶é—´æˆ³è‡ªåŠ¨æ£€æµ‹æ—©é¤/åˆé¤/æ™šé¤/é›¶é£Ÿ |
| ğŸ’¡ **æ™ºèƒ½æ¨è** | åŸºäºè¥å…»ç¼ºå£æ¨èä¸‹ä¸€é¤ |
| ğŸ’¾ **æ•°æ®æŒä¹…åŒ–** | å°†å®Œæ•´çš„ç”¨é¤å†å²å­˜å‚¨åœ¨ç»“æ„åŒ– JSON æ•°æ®åº“ä¸­ |

### ç”¨æˆ·ä½“éªŒ

- âœ… **ä¸€é”®åˆ†æ**: ä¸Šä¼ ç…§ç‰‡ â†’ è‡ªåŠ¨è·å–å®Œæ•´åˆ†æ
- âœ… **æ— éœ€æ‰‹åŠ¨è¾“å…¥**: æ— éœ€è¾“å…¥èœå“åç§°æˆ–ä»½é‡å¤§å°
- âœ… **å†å²è¿½è¸ª**: æŸ¥è¯¢å’Œå¯è§†åŒ–è¿‡å¾€ç”¨é¤è®°å½•
- âœ… **è¶‹åŠ¿æ´å¯Ÿ**: äº†è§£ä½ çš„é¥®é£Ÿä¹ æƒ¯
- âœ… **å¯æ“ä½œå»ºè®®**: è·å–ä¸‹ä¸€é¤çš„å…·ä½“é£Ÿç‰©æ¨è

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### ç³»ç»Ÿç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     NutriFlow AI å¹³å°                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   å‰ç«¯ç•Œé¢  â”‚â”€â”€â”€â”€â–¶â”‚  API åç«¯    â”‚â”€â”€â”€â”€â–¶â”‚  AI åç«¯    â”‚ â”‚
â”‚  â”‚  (React/TS) â”‚â—€â”€â”€â”€â”€â”‚  (Node.js)   â”‚â—€â”€â”€â”€â”€â”‚  (Python)   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                    â”‚                     â”‚        â”‚
â”‚         â”‚                    â”‚                     â”‚        â”‚
â”‚    ç”¨æˆ·ä¸Šä¼               è®¤è¯ä¸ API            LangChain    â”‚
â”‚    ç•Œé¢æ˜¾ç¤º              è·¯ç”±åˆ†å‘              12ä¸ªå·¥å…·     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ

#### å‰ç«¯ (`nutrition_tracker_frontend/`)
- **æ¡†æ¶**: Next.js 14 + React 18
- **è¯­è¨€**: TypeScript
- **UI åº“**: shadcn/ui (Tailwind CSS)
- **æ ¸å¿ƒåŠŸèƒ½**: 
  - å“åº”å¼ç›¸æœºç•Œé¢ç”¨äºæ‹æ‘„é¤é£Ÿ
  - å®æ—¶è¥å…»æ˜¾ç¤º
  - å†å²æ•°æ®å¯è§†åŒ–
  - ç”¨æˆ·è®¤è¯

#### API åç«¯ (`nutrition_tracker_backend/`)
- **è¿è¡Œæ—¶**: Node.js
- **æ¡†æ¶**: Express.js
- **è®¤è¯**: åŸºäº JWT çš„è®¤è¯
- **æ ¸å¿ƒåŠŸèƒ½**:
  - RESTful API ç«¯ç‚¹
  - å›¾ç‰‡ä¸Šä¼ å¤„ç†
  - ç”¨æˆ·ä¼šè¯ç®¡ç†
  - è¯·æ±‚è·¯ç”±åˆ° AI åç«¯

#### AI åç«¯ (`nutrition_tracker_AI/`)
- **æ¡†æ¶**: LangChain 1.0 + LangGraph
- **æ¨¡å‹**: 
  - Qwen-VL-Plus (è§†è§‰)
  - Qwen-Plus (æ–‡æœ¬æ¨ç†)
- **å·¥å…·**: 12 ä¸ªä¸“ä¸šä»£ç†å·¥å…·
- **æ•°æ®åº“**: åŸºäº JSON çš„ç»“æ„åŒ–å­˜å‚¨
- **æ ¸å¿ƒåŠŸèƒ½**:
  - å¤šæ¨¡æ€å›¾åƒåˆ†æ
  - åœ¨çº¿è¥å…»æŸ¥è¯¢
  - å¥åº·è¯„åˆ†ç®—æ³•
  - è†³é£Ÿæ¨è

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- **Python**: 3.12 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Node.js**: 18.x æˆ–æ›´é«˜ç‰ˆæœ¬
- **é˜¿é‡Œäº‘ API å¯†é’¥**: DashScope (é€šä¹‰åƒé—®æ¨¡å‹)

### å®‰è£…æ­¥éª¤

#### 1. å…‹éš†ä»“åº“

```bash
git clone https://github.com/severin-ye/NutriFlow-AI.git
cd NutriFlow-AI
```

#### 2. é…ç½® AI åç«¯

```bash
cd nutrition_tracker_AI

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv .venv
source .venv/bin/activate  # Windows ç³»ç»Ÿä½¿ç”¨: .venv\Scripts\activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# åˆ›å»º .env æ–‡ä»¶
echo "DASHSCOPE_API_KEY=your_api_key_here" > .env
```

**è·å– API å¯†é’¥**: è®¿é—® [é˜¿é‡Œäº‘ç™¾ç‚¼å¹³å°](https://bailian.console.aliyun.com/)

#### 3. é…ç½® API åç«¯

```bash
cd ../nutrition_tracker_backend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨æœåŠ¡å™¨
npm start
```

#### 4. é…ç½®å‰ç«¯

```bash
cd ../nutrition_tracker_frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### è¿è¡Œç³»ç»Ÿ

**æ–¹æ¡ˆ A: å®Œæ•´å †æ ˆï¼ˆæ¨èï¼‰**

```bash
# ç»ˆç«¯ 1 - AI åç«¯
cd nutrition_tracker_AI
source .venv/bin/activate
python agent_server.py

# ç»ˆç«¯ 2 - API åç«¯
cd nutrition_tracker_backend
npm start

# ç»ˆç«¯ 3 - å‰ç«¯
cd nutrition_tracker_frontend
npm run dev
```

è®¿é—®: `http://localhost:3000`

**æ–¹æ¡ˆ B: ä»… AI åç«¯å‘½ä»¤è¡Œ**

```bash
cd nutrition_tracker_AI
source .venv/bin/activate
python main.py
```

---

## ğŸ“š æ–‡æ¡£

### é¡¹ç›®ç»“æ„

```
NutriFlow-AI/
â”œâ”€â”€ ğŸ“ nutrition_tracker_AI/          # AI åç«¯ (Python)
â”‚   â”œâ”€â”€ main.py                       # å‘½ä»¤è¡Œå…¥å£
â”‚   â”œâ”€â”€ agent_server.py               # Flask/FastAPI æœåŠ¡å™¨
â”‚   â”œâ”€â”€ ai_nutrition_agent/           # æ ¸å¿ƒä»£ç†åŒ…
â”‚   â”‚   â”œâ”€â”€ agent.py                  # LangGraph ä»£ç†ï¼ˆ12ä¸ªå·¥å…·ï¼‰
â”‚   â”‚   â”œâ”€â”€ config/settings.py        # é…ç½®
â”‚   â”‚   â”œâ”€â”€ tools/                    # 12 ä¸ªä¸“ä¸šå·¥å…·
â”‚   â”‚   â”œâ”€â”€ schemas/                  # Pydantic æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ prompts/                  # LLM æç¤ºè¯æ¨¡æ¿
â”‚   â”‚   â””â”€â”€ db/meals.json            # æ•°æ®åº“
â”‚   â””â”€â”€ tests/                        # æµ‹è¯•å¥—ä»¶
â”‚
â”œâ”€â”€ ğŸ“ nutrition_tracker_backend/      # API åç«¯ (Node.js)
â”‚   â”œâ”€â”€ server.js                     # Express æœåŠ¡å™¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ controllers/              # è·¯ç”±å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ middleware/auth.js        # JWT è®¤è¯
â”‚   â”‚   â””â”€â”€ routes/                   # API è·¯ç”±
â”‚   â””â”€â”€ uploads/                      # ä¸´æ—¶å›¾ç‰‡å­˜å‚¨
â”‚
â””â”€â”€ ğŸ“ nutrition_tracker_frontend/     # å‰ç«¯ (React)
    â”œâ”€â”€ app/                          # Next.js åº”ç”¨ç›®å½•
    â”‚   â”œâ”€â”€ page.tsx                  # ä¸»è¿½è¸ªé¡µé¢
    â”‚   â”œâ”€â”€ auth/page.tsx             # ç™»å½•/æ³¨å†Œ
    â”‚   â””â”€â”€ summary/page.tsx          # æ¯æ—¥æ€»ç»“
    â”œâ”€â”€ components/
    â”‚   â”œâ”€â”€ nutrition-tracker.tsx     # ä¸»ç»„ä»¶
    â”‚   â””â”€â”€ daily-summary.tsx         # æ€»ç»“è§†å›¾
    â””â”€â”€ types/                        # TypeScript ç±»å‹å®šä¹‰
```

### AI åç«¯ï¼š12 ä¸ªä»£ç†å·¥å…·

| # | å·¥å…·åç§° | ç›®çš„ | è¾“å…¥ | è¾“å‡º |
|---|---------|------|------|------|
| 1 | `detect_dishes_and_portions` | é€šè¿‡ Qwen-VL è¿›è¡Œå›¾åƒè¯†åˆ« | image_path | JSON: èœå“æ•°ç»„ |
| 2 | `check_and_refine_portions` | ä»½é‡éªŒè¯ | vision_result | JSON: å·²éªŒè¯çš„ä»½é‡ |
| 3 | `add_nutrition_to_dishes` | æ‰¹é‡è¥å…»æŸ¥è¯¢ | portion_result | JSON: å¸¦ nutrition_per_100g |
| 4 | `query_nutrition_per_100g` | å•ä¸ªèœå“æŸ¥è¯¢ | dish_name | JSON: è¥å…»æ•°æ® |
| 5 | `compute_meal_nutrition` | è®¡ç®—æ€»é‡ | nutrition_result | JSON: meal_nutrition_total |
| 6 | `save_meal` | æ•°æ®åº“æŒä¹…åŒ– | compute_result | çŠ¶æ€æ¶ˆæ¯ |
| 7 | `load_recent_meals` | åŠ è½½å†å²è®°å½• | days (int) | JSON: æœ€è¿‘çš„é¤é£Ÿ |
| 8 | `get_daily_summary` | æ¯æ—¥æŠ¥å‘Š | date (å¯é€‰) | JSON: æ¯æ—¥æ€»ç»“ |
| 9 | `score_current_meal` | åŸºç¡€å¥åº·è¯„åˆ† | meal_nutrition | åˆ†æ•° + å»ºè®® |
| 10 | `score_current_meal_llm` | åŸºäº LLM çš„è¯„åˆ† | meal_data | è¯¦ç»†åˆ†æ•° |
| 11 | `score_weekly_adjusted` | æ¯å‘¨è¶‹åŠ¿è¯„åˆ† | weekly_data | è°ƒæ•´åçš„åˆ†æ•° |
| 12 | `recommend_next_meal` | ä¸‹ä¸€é¤å»ºè®® | history + current | æ¨è |

### å·¥ä½œæµç¨‹

```
ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡
    â†“
å‰ç«¯ â†’ API åç«¯ â†’ AI ä»£ç†
                    â†“
            1. Qwen-VL: å›¾ç‰‡ â†’ èœå“
            2. éªŒè¯ä»½é‡
            3. æŸ¥è¯¢è¥å…»ï¼ˆåœ¨çº¿ï¼‰
            4. è®¡ç®—æ€»é‡
            5. å¥åº·è¯„åˆ†
            6. ç”Ÿæˆæ¨è
            7. ä¿å­˜åˆ°æ•°æ®åº“
                    â†“
å‰ç«¯ â† API åç«¯ â† JSON å“åº”
    â†“
æ˜¾ç¤ºåˆ†ææŠ¥å‘Š
```

---

## ğŸ”Œ API æ–‡æ¡£

### AI åç«¯ç«¯ç‚¹

#### `POST /analyze`
åˆ†æé¤é£Ÿå›¾ç‰‡å¹¶è¿”å›å®Œæ•´çš„è¥å…»åˆ†æã€‚

**è¯·æ±‚:**
```json
{
  "image_path": "/path/to/meal.jpg",
  "user_id": "user001"
}
```

**å“åº”:**
```json
{
  "dishes": [
    {
      "name": "å®«ä¿é¸¡ä¸",
      "category": "meat_dish",
      "final_weight_g": 300,
      "nutrition_total": {
        "calories": 345.0,
        "protein": 25.5,
        "fat": 18.6,
        "carbs": 21.9,
        "sodium": 960.0
      }
    }
  ],
  "meal_nutrition_total": {
    "calories": 345.0,
    "protein": 25.5,
    "fat": 18.6,
    "carbs": 21.9,
    "sodium": 960.0
  },
  "health_score": 75,
  "recommendations": ["ä¸‹ä¸€é¤ï¼šä½é’ ã€é«˜çº¤ç»´..."]
}
```

### API åç«¯ç«¯ç‚¹

#### è®¤è¯

- `POST /api/auth/register` - æ³¨å†Œæ–°ç”¨æˆ·
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•ï¼ˆè¿”å› JWTï¼‰

#### é¤é£Ÿåˆ†æ

- `POST /api/analyze` - ä¸Šä¼ å¹¶åˆ†æé¤é£Ÿå›¾ç‰‡
- `GET /api/meals` - è·å–ç”¨æˆ·çš„é¤é£Ÿå†å²
- `GET /api/meals/:date` - è·å–ç‰¹å®šæ—¥æœŸçš„é¤é£Ÿ

---

## ğŸ§ª æµ‹è¯•

### AI åç«¯æµ‹è¯•

```bash
cd nutrition_tracker_AI
source .venv/bin/activate

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python -m pytest tests/

# ç‰¹å®šæµ‹è¯•
python tests/test_complete_chain.py  # é›†æˆæµ‹è¯•
python tests/verify_db.py            # æ•°æ®åº“éªŒè¯
```

**æµ‹è¯•è¦†ç›–:**
- âœ… è§†è§‰å·¥å…· (Qwen-VL é›†æˆ)
- âœ… ä»½é‡éªŒè¯
- âœ… è¥å…»æŸ¥è¯¢ï¼ˆåœ¨çº¿ï¼‰
- âœ… è¥å…»è®¡ç®—
- âœ… æ•°æ®åº“æ“ä½œ
- âœ… å®Œæ•´å·¥å…·é“¾ï¼ˆç«¯åˆ°ç«¯ï¼‰

### æµ‹è¯•è¾“å‡ºç¤ºä¾‹

```
======================================================================
ğŸ§ª æµ‹è¯•å®Œæ•´å·¥å…·é“¾
======================================================================

1ï¸âƒ£  è§†è§‰: âœ… è¯†åˆ«å‡º 1 é“èœ
2ï¸âƒ£  ä»½é‡: âœ… éªŒè¯ 300g (å¤§ä»½)
3ï¸âƒ£  è¥å…»: âœ… åœ¨çº¿æŸ¥è¯¢ (115 åƒå¡/100g)
4ï¸âƒ£  è®¡ç®—: âœ… æ€»è®¡ 345 åƒå¡, 25.5g è›‹ç™½è´¨
5ï¸âƒ£  ä¿å­˜: âœ… å·²ä¿å­˜åˆ°æ•°æ®åº“ (meal_2025-12-08_1)

======================================================================
âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼
======================================================================
```

---

## ğŸ”§ é…ç½®

### ç¯å¢ƒå˜é‡

**AI åç«¯** (`nutrition_tracker_AI/` ä¸­çš„ `.env`):
```bash
DASHSCOPE_API_KEY=sk-xxxxxxxxxxxxx
QWEN_VL_MODEL=qwen-vl-plus
QWEN_TEXT_MODEL=qwen-plus
```

**API åç«¯** (`nutrition_tracker_backend/` ä¸­çš„ `.env`):
```bash
PORT=5000
JWT_SECRET=your_secret_key
AI_BACKEND_URL=http://localhost:8000
```

**å‰ç«¯** (`nutrition_tracker_frontend/` ä¸­çš„ `.env.local`):
```bash
NEXT_PUBLIC_API_URL=http://localhost:5000
```

### å…³é”®è®¾ç½®

**AI ä»£ç†é…ç½®** (`nutrition_tracker_AI/ai_nutrition_agent/config/settings.py`):
```python
DASHSCOPE_API_KEY        # API å¯†é’¥
QWEN_VL_MODEL           # è§†è§‰æ¨¡å‹åç§°
QWEN_TEXT_MODEL         # æ–‡æœ¬æ¨¡å‹åç§°
DB_PATH                 # æ•°æ®åº“æ–‡ä»¶è·¯å¾„
RECENT_DAYS = 7         # è¶‹åŠ¿åˆ†æçš„å¤©æ•°
```

---

## ğŸ“Š æ•°æ®åº“æ¶æ„

### meals.json ç»“æ„

```json
{
  "user_id": "user001",
  "days": [
    {
      "date": "2025-12-09",
      "daily_summary": {
        "total_calories": 1850.0,
        "total_protein": 85.2,
        "total_fat": 62.5,
        "total_carbs": 210.3,
        "total_sodium": 2500.0,
        "daily_score": 78
      },
      "meals": [
        {
          "meal_id": "meal_2025-12-09_1",
          "timestamp": "2025-12-09T08:30:00",
          "image_path": "/uploads/breakfast.jpg",
          "dishes": [
            {
              "dish_id": "dish_1",
              "name": "ç‚’é¸¡è›‹",
              "category": "protein",
              "estimated_weight_g": 150,
              "final_weight_g": 150,
              "portion_level": "medium",
              "nutrition_per_100g": {
                "calories": 140.0,
                "protein": 12.5,
                "fat": 9.5,
                "carbs": 1.5,
                "sodium": 150.0
              },
              "nutrition_total": {
                "calories": 210.0,
                "protein": 18.8,
                "fat": 14.3,
                "carbs": 2.3,
                "sodium": 225.0
              }
            }
          ],
          "meal_nutrition_total": {
            "calories": 210.0,
            "protein": 18.8,
            "fat": 14.3,
            "carbs": 2.3,
            "sodium": 225.0
          }
        }
      ]
    }
  ]
}
```

---

## ğŸ” å®‰å…¨

- **è®¤è¯**: åŸºäº JWT çš„ API ç«¯ç‚¹è®¤è¯
- **API å¯†é’¥**: é˜¿é‡Œäº‘ API å¯†é’¥å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡ä¸­
- **æ•°æ®éšç§**: ç”¨æˆ·æ•°æ®æœ¬åœ°å­˜å‚¨ï¼Œä¸å‘é€ç»™ç¬¬ä¸‰æ–¹
- **å›¾ç‰‡å­˜å‚¨**: å¤„ç†åæ¸…ç†ä¸´æ—¶ä¸Šä¼ æ–‡ä»¶

---

## ğŸ› æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### 1. "DASHSCOPE_API_KEY not configured"

**è§£å†³æ–¹æ¡ˆ:**
- ç¡®ä¿ `.env` æ–‡ä»¶å­˜åœ¨äº `nutrition_tracker_AI/` ç›®å½•
- æ£€æŸ¥ API å¯†é’¥æ ¼å¼ï¼ˆåº”ä»¥ `sk-` å¼€å¤´ï¼‰
- æ·»åŠ  `.env` åé‡å¯åº”ç”¨ç¨‹åº

#### 2. å›¾åƒè¯†åˆ«è¿”å›ç©ºç»“æœ

**å¯èƒ½åŸå› :**
- ä¸æ”¯æŒçš„å›¾ç‰‡æ ¼å¼ï¼ˆä½¿ç”¨ JPGã€PNG æˆ– WebPï¼‰
- å›¾ç‰‡å¤ªå¤§ï¼ˆä¿æŒåœ¨ 5MB ä»¥ä¸‹ï¼‰
- å›¾ç‰‡è´¨é‡æˆ–å…‰çº¿ä¸ä½³
- API é…é¢å·²ç”¨å°½

**è§£å†³æ–¹æ¡ˆ:**
- ä½¿ç”¨æ”¯æŒçš„æ ¼å¼å¹¶å‹ç¼©å›¾ç‰‡
- æ‹ç…§æ—¶ç¡®ä¿å…‰çº¿å……è¶³
- æ£€æŸ¥ DashScope è´¦æˆ·ä½™é¢

#### 3. æ•°æ®åº“æ–‡ä»¶ä¸ºç©º/æŸå

**è§£å†³æ–¹æ¡ˆ:**
- ç³»ç»Ÿä¼šè‡ªåŠ¨åˆå§‹åŒ–ç©ºæ•°æ®åº“
- æ£€æŸ¥ `db/meals.json` çš„æ–‡ä»¶æƒé™
- å¦‚æœæŸåï¼Œåˆ é™¤æ–‡ä»¶å¹¶é‡å¯ï¼ˆå°†åˆ›å»ºæ–°æ–‡ä»¶ï¼‰

#### 4. è¥å…»å€¼å…¨ä¸ºé›¶

**åŸå› :** ç¼ºå°‘ `add_nutrition_to_dishes` å·¥å…·è°ƒç”¨

**è§£å†³æ–¹æ¡ˆ:** 
- å½“å‰ç‰ˆæœ¬å·²ä¿®å¤
- ä»£ç†ç³»ç»Ÿæç¤ºè¯ç¡®ä¿è°ƒç”¨æ­¤å·¥å…·
- è¿è¡Œ `python tests/test_complete_chain.py` éªŒè¯

#### 5. å‰ç«¯æ— æ³•è¿æ¥åç«¯

**è§£å†³æ–¹æ¡ˆ:**
- éªŒè¯æ‰€æœ‰ä¸‰ä¸ªæœåŠ¡éƒ½åœ¨è¿è¡Œ
- æ£€æŸ¥ `.env` æ–‡ä»¶æ˜¯å¦æœ‰æ­£ç¡®çš„ URL
- ç¡®ä¿æ²¡æœ‰ç«¯å£å†²çªï¼ˆ3000ã€5000ã€8000ï¼‰

---

## ğŸ¯ å¼€å‘è·¯çº¿å›¾

### ç¬¬ä¸€é˜¶æ®µ: æ ¸å¿ƒåŠŸèƒ½ï¼ˆâœ… å·²å®Œæˆï¼‰
- [x] AI å›¾åƒè¯†åˆ«
- [x] è¥å…»è®¡ç®—
- [x] å¥åº·è¯„åˆ†
- [x] æ•°æ®åº“æŒä¹…åŒ–
- [x] å‘½ä»¤è¡Œç•Œé¢
- [x] å®Œæ•´æµ‹è¯•å¥—ä»¶

### ç¬¬äºŒé˜¶æ®µ: å…¨æ ˆå¼€å‘ï¼ˆğŸš§ è¿›è¡Œä¸­ï¼‰
- [x] API åç«¯
- [x] React å‰ç«¯
- [x] ç”¨æˆ·è®¤è¯
- [ ] å¤šç”¨æˆ·æ”¯æŒ
- [ ] æ•°æ®å¯è§†åŒ–ä»ªè¡¨æ¿

### ç¬¬ä¸‰é˜¶æ®µ: é«˜çº§åŠŸèƒ½ï¼ˆğŸ“‹ è®¡åˆ’ä¸­ï¼‰
- [ ] ç§»åŠ¨åº”ç”¨ï¼ˆReact Nativeï¼‰
- [ ] åŒ…è£…é£Ÿå“æ¡å½¢ç æ‰«æ
- [ ] é£Ÿè°±æ¨è
- [ ] è†³é£Ÿè®¡åˆ’æ—¥å†
- [ ] å¯¼å‡ºæŠ¥å‘Šï¼ˆPDF/Excelï¼‰
- [ ] ç¤¾äº¤åŠŸèƒ½ï¼ˆåˆ†äº«é¤é£Ÿï¼‰
- [ ] ä¸å¥èº«åº”ç”¨é›†æˆ

### ç¬¬å››é˜¶æ®µ: æ™ºèƒ½å‡çº§ï¼ˆğŸ”® æœªæ¥ï¼‰
- [ ] è‡ªå®šä¹‰é¥®é£Ÿç›®æ ‡
- [ ] è¿‡æ•/é¥®é£Ÿé™åˆ¶æ”¯æŒ
- [ ] å¾®é‡è¥å…»ç´ è¿½è¸ª
- [ ] è¿åŠ¨å¡è·¯é‡Œé›†æˆ
- [ ] é¢„æµ‹æ€§è†³é£Ÿå»ºè®®
- [ ] è¯­éŸ³ç•Œé¢

---

## ğŸ¤ è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿è´¡çŒ®ï¼ä»¥ä¸‹æ˜¯ä½ å¯ä»¥æä¾›å¸®åŠ©çš„æ–¹å¼ï¼š

1. **æŠ¥å‘Šé”™è¯¯**: æ‰“å¼€ä¸€ä¸ª issue å¹¶è¯¦ç»†æè¿°
2. **å»ºè®®åŠŸèƒ½**: åœ¨è®¨è®ºåŒºåˆ†äº«ä½ çš„æƒ³æ³•
3. **æäº¤ PR**: 
   - Fork ä»“åº“
   - åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
   - æäº¤æ›´æ”¹ (`git commit -m 'Add AmazingFeature'`)
   - æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
   - æ‰“å¼€ Pull Request

### å¼€å‘æŒ‡å—

- éµå¾ªç°æœ‰ä»£ç é£æ ¼
- ä¸ºæ–°åŠŸèƒ½æ·»åŠ æµ‹è¯•
- æ›´æ–°æ–‡æ¡£
- ä¿æŒæäº¤åŸå­åŒ–å¹¶æœ‰è‰¯å¥½çš„æè¿°

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

### ç¬¬ä¸‰æ–¹è®¸å¯è¯

- **LangChain**: MIT è®¸å¯è¯
- **é˜¿é‡Œå·´å·´é€šä¹‰åƒé—®æ¨¡å‹**: å•†ä¸šä½¿ç”¨éœ€è¦é˜¿é‡Œäº‘åè®®
- **React**: MIT è®¸å¯è¯
- **Next.js**: MIT è®¸å¯è¯
- **shadcn/ui**: MIT è®¸å¯è¯

---

## ğŸ™ è‡´è°¢

### æ ¸å¿ƒæŠ€æœ¯
- [LangChain](https://github.com/langchain-ai/langchain) - ä»£ç†æ¡†æ¶
- [LangGraph](https://github.com/langchain-ai/langgraph) - å·¥ä½œæµç¼–æ’
- [é˜¿é‡Œäº‘é€šä¹‰åƒé—®](https://www.aliyun.com/product/bailian) - å¤šæ¨¡æ€ AI æ¨¡å‹
- [Pydantic](https://github.com/pydantic/pydantic) - æ•°æ®éªŒè¯
- [Next.js](https://nextjs.org/) - React æ¡†æ¶
- [shadcn/ui](https://ui.shadcn.com/) - UI ç»„ä»¶

### çµæ„Ÿæ¥æº
- YOLO ç›®æ ‡æ£€æµ‹æ¦‚å¿µ
- MyFitnessPal è¥å…»è¿½è¸ªç”¨æˆ·ä½“éªŒ
- Calorie Mama AI é©±åŠ¨çš„é£Ÿç‰©è¯†åˆ«

---

## ğŸ“§ è”ç³»ä¸æ”¯æŒ

- **ä½œè€…**: Severin Ye
- **GitHub**: [@severin-ye](https://github.com/severin-ye)
- **ä»“åº“**: [NutriFlow-AI](https://github.com/severin-ye/NutriFlow-AI)
- **é—®é¢˜**: [æŠ¥å‘Šé”™è¯¯](https://github.com/severin-ye/NutriFlow-AI/issues)

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æ‰“å¼€ä¸€ä¸ª issue æˆ–å¼€å§‹è®¨è®ºã€‚

---

## ğŸ“ˆ ç»Ÿè®¡

![Python](https://img.shields.io/badge/Python-3.12+-blue.svg)
![Node.js](https://img.shields.io/badge/Node.js-18+-green.svg)
![React](https://img.shields.io/badge/React-18+-61DAFB.svg)
![LangChain](https://img.shields.io/badge/LangChain-1.0-orange.svg)
![License](https://img.shields.io/badge/License-MIT-yellow.svg)

**é¡¹ç›®ç»Ÿè®¡:**
- ğŸ Python ä»£ç è¡Œæ•°: ~2,000
- ğŸŸ¢ JavaScript/TypeScript ä»£ç è¡Œæ•°: ~1,500
- ğŸ§ª æµ‹è¯•è¦†ç›–ç‡: 80%+
- ğŸ› ï¸ AI å·¥å…·: 12 ä¸ª
- ğŸ“Š æ•°æ®æ¨¡å‹: 8 ä¸ª
- ğŸ“ æç¤ºè¯æ¨¡æ¿: 6 ä¸ª

---

<div align="center">

**ç”± Severin Ye ç”¨ â¤ï¸ æ„å»º**

â­ å¦‚æœè§‰å¾—æœ‰å¸®åŠ©ï¼Œè¯·ç»™è¿™ä¸ªé¡¹ç›®ç‚¹ä¸ªæ˜Ÿï¼

[è¿”å›é¡¶éƒ¨](#-nutriflow-ai---æ™ºèƒ½è¥å…»åˆ†æç³»ç»Ÿ)

</div>

---

**æœ€åæ›´æ–°**: 2025å¹´12æœˆ9æ—¥
**ç‰ˆæœ¬**: 1.0.0
